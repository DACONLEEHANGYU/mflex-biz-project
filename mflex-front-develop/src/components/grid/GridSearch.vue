<template>
  <div class="grid-search">
    <!-- í‘œì¤€í™” ì‘ì—…ìš©ì–´ í‘œì‹œ -->
    <div v-if="gridDefs.scrnGridId == 'MFGRD200'" class="job-visible-div">
      <div>
        <span>ì‘ì—…ìš©ì–´ : </span>
      </div>
      <div class="job-visible-select">
        <select
          class="input-select"
          v-model="selectActualizingTermJobVisible"
          style="width: 100%"
        >
          <option value="visible">í¬í•¨</option>
          <option value="noneVisible">ë¯¸í¬í•¨</option>
        </select>
      </div>

      <div class="divider-vertical"></div>
    </div>

    <!-- ì‘ì—…ìš©ì–´ í‘œì‹œ -->
    <div v-if="gridDefs.scrnGridId == 'MFGRD040'" class="job-visible-div">
      <div>
        <span>ì‘ì—…ìš©ì–´ : </span>
      </div>
      <div class="job-visible-select">
        <select
          class="input-select"
          v-model="selectTermJobVisible"
          style="width: 100%"
        >
          <option value="visible">í¬í•¨</option>
          <option value="noneVisible">ë¯¸í¬í•¨</option>
        </select>
      </div>

      <div class="divider-vertical"></div>
    </div>

    <!-- ë‹¨ì–´í‘œì¤€í™” ì‘ì—…ë‹¨ì–´ í‘œì‹œ -->
    <div v-if="gridDefs.scrnGridId == 'MFGRD220'" class="job-visible-div">
      <div>
        <span>ì‘ì—…ë‹¨ì–´ : </span>
      </div>
      <div class="job-visible-select">
        <select
          class="input-select"
          v-model="selectActualizingWordJobVisible"
          style="width: 100%"
        >
          <option value="visible">í¬í•¨</option>
          <option value="noneVisible">ë¯¸í¬í•¨</option>
        </select>
      </div>

      <div class="divider-vertical"></div>
    </div>

    <!-- ë‹¨ì–´ë“±ë¡ ì‘ì—…ë‹¨ì–´ í‘œì‹œ -->
    <div v-if="gridDefs.scrnGridId == 'MFGRD041'" class="job-visible-div">
      <div>
        <span>ì‘ì—…ë‹¨ì–´ : </span>
      </div>
      <div class="job-visible-select">
        <select
          class="input-select"
          v-model="selectWordJobVisible"
          style="width: 100%"
        >
          <option value="visible">í¬í•¨</option>
          <option value="noneVisible">ë¯¸í¬í•¨</option>
        </select>
      </div>

      <div class="divider-vertical"></div>
    </div>

    <!-- ë„ë©”ì¸ë“±ë¡ ì‘ì—…ë„ë©”ì¸ í‘œì‹œ -->
    <div v-if="gridDefs.scrnGridId == 'MFGRD042'" class="job-visible-div">
      <div>
        <span>ì‘ì—…ë„ë©”ì¸ : </span>
      </div>
      <div class="job-visible-select">
        <select
          class="input-select"
          v-model="selectDomainJobVisible"
          style="width: 100%"
        >
          <option value="visible">í¬í•¨</option>
          <option value="nonVisible">ë¯¸í¬í•¨</option>
        </select>
      </div>

      <div class="divider-vertical"></div>
    </div>

    <!-- ìš©ì–´ì¡°íšŒ ì‚¬ì „ì„ íƒ í‘œì‹œ -->
    <div v-if="gridDefs.scrnGridId == 'MFGRD017'" class="job-visible-div">
      <!-- <div class="divider-vertical"></div> -->

      <div>
        <!-- <span>ì‚¬ì „ì„ íƒ : </span> -->
      </div>
      <div class="job-visible-select">
        <select
          class="input-select"
          v-model="selectTermDictionarySearchCode"
          style="width: 100%"
        >
          <option value="ALL">ì „ì²´</option>
          <option value="INDIVIDUAL">ë‚´ ì‚¬ì „</option>
          <option value="UPPER">ìƒìœ„ì‚¬ì „</option>
          <option value="EXTERNAL">ê³µì‹ì‚¬ì „</option>
        </select>
      </div>

      <div class="divider-vertical"></div>
    </div>

    <!-- ë‹¨ì–´ì¡°íšŒ ì‚¬ì „ì„ íƒ í‘œì‹œ -->
    <div v-if="gridDefs.scrnGridId == 'MFGRD005'" class="job-visible-div">
      <!-- <div class="divider-vertical"></div> -->

      <div>
        <!-- <span>ì‚¬ì „ì„ íƒ : </span> -->
      </div>
      <div class="job-visible-select">
        <select
          class="input-select"
          v-model="selectWordDictionarySearchCode"
          style="width: 100%"
        >
          <option value="ALL">ì „ì²´</option>
          <option value="INDIVIDUAL">ë‚´ ì‚¬ì „</option>
          <option value="UPPER">ìƒìœ„ì‚¬ì „</option>
          <option value="EXTERNAL">ê³µì‹ì‚¬ì „</option>
        </select>
      </div>

      <div class="divider-vertical"></div>
    </div>

    <!-- ë„ë©”ì¸ì¸ì¡°íšŒ ì‚¬ì „ì„ íƒ í‘œì‹œ -->
    <div v-if="gridDefs.scrnGridId == 'MFGRD009'" class="job-visible-div">
      <!-- <div class="divider-vertical"></div> -->

      <div>
        <!-- <span>ì‚¬ì „ì„ íƒ : </span> -->
      </div>
      <div class="job-visible-select">
        <select
          class="input-select"
          v-model="selectDomainDictionarySearchCode"
          style="width: 100%"
        >
          <option value="ALL">ì „ì²´</option>
          <option value="INDIVIDUAL">ë‚´ ì‚¬ì „</option>
          <option value="UPPER">ìƒìœ„ì‚¬ì „</option>
          <option value="EXTERNAL">ê³µì‹ì‚¬ì „</option>
        </select>
      </div>

      <div class="divider-vertical"></div>
    </div>

    <!-- ë„ë©”ì¸í‘œì¤€í™” ì‘ì—…ë„ë©”ì¸ í‘œì‹œ -->
    <div v-if="gridDefs.scrnGridId == 'MFGRD240'" class="job-visible-div">
      <div>
        <span>ì‘ì—…ë„ë©”ì¸ : </span>
      </div>
      <div class="job-visible-select">
        <select
          class="input-select"
          v-model="selectActualizingDomainJobVisible"
          style="width: 100%"
        >
          <option value="visible">í¬í•¨</option>
          <option value="nonVisible">ë¯¸í¬í•¨</option>
        </select>
      </div>

      <div class="divider-vertical"></div>
    </div>

    <div class="search-result" v-if="resultCount.count">
      <!-- <i class="icon"></i> -->
      <span class="result-title">ì¡°íšŒê²°ê³¼ :</span>
      <strong>{{ resultCount.count }}</strong
      >ê±´<span class="result-line">/</span
      ><strong>{{ resultCount.total }}</strong
      >ê±´
    </div>
    <div class="search-result" v-else>
      <i class="icon"></i><span class="result-title">ì¡°íšŒê²°ê³¼ :</span>
      <strong>{{ resultCount.total }}</strong
      >ê±´
    </div>

    <div class="search-inputs">
      <div class="inputtext__area">
        <template v-if="inputType">
          <AppInput
            class="target-search-area"
            v-model="searchText"
            style="width: 100%"
            @keyup.enter="onEnter"
          />
        </template>
        <template v-else>
          <textarea
            v-model="searchText"
            style="width: 100%; height: auto"
            rows="3"
          ></textarea>
        </template>
        <span class="btn-chInput target-position" @click="changeType"></span>
        <span
          v-if="searchText !== ''"
          class="btn-search"
          @click="onEnter"
          title="í™•ì¸"
        ></span>
        <span
          v-if="searchText === ''"
          class="btn-reload"
          @click="onEnter"
          title="í™•ì¸"
        ></span>
      </div>
    </div>
    <div class="search-btns">
      <button
        v-if="searchType === 'query'"
        class="btn-filter__chatbot"
        title="ì¿¼ë¦¬ ìƒì„±ê¸°"
        @click="onOpenChatBot"
      ></button>
      <!-- <button
        class="btn-header__pinset"
        title="ì„¤ì •í•œ í•„í„° ì €ì¥"
        @click="onSave"
      ></button> -->
      <button
        class="btn-filter__save"
        title="ê·¸ë¦¬ë“œ ì„¤ì • ì €ì¥"
        @click="onSave"
      ></button>
      <!-- <button
        class="btn-filter__set"
        title="ë§ì¶¤í•„í„°ì„¤ì •"
        @click="requestColumnState"
      ></button> -->
      <button
        class="btn-filter__set"
        title="ê·¸ë¦¬ë“œ ì»¬ëŸ¼ ì„¤ì •"
        @click="onOpenFilterWindow"
      ></button>
      <button
        class="btn-filter__remove"
        title="í•„í„° ë° ì •ë ¬ ì‚­ì œ"
        @click="onRemove"
      ></button>
    </div>

    <!-- ë‹¨ì–´ë“±ë¡ ì‘ì—…ë‹¨ì–´ í‘œì‹œ -->
    <div v-if="gridDefs.scrnGridId == 'MFGRD041'" class="job-visible-div">
      <div class="divider-vertical"></div>

      <div>
        <span>ì‘ì—…ë‹¨ì–´ : </span>
      </div>
      <div class="job-visible-select">
        <select
          class="input-select"
          v-model="selectWordJobVisible"
          style="width: 100%"
        >
          <option value="visible">í¬í•¨</option>
          <option value="noneVisible">ë¯¸í¬í•¨</option>
        </select>
      </div>
    </div>

    <div class="divider-vertical"></div>
    <!-- <button class="btn-s" @click="onChangeSearchType">ë²„íŠ¼</button> -->

    <!-- í† ê¸€ ë²„íŠ¼ -->
    <ToggleBtn @change-search-type="onChangeSearchType" />

    <div class="divider-vertical"></div>

    <!-- ğŸ”¥ ìˆ˜ì •ëœ ì—‘ì…€ ë‹¤ìš´ë¡œë“œ ë“œë¡­ë‹¤ìš´ -->
    <div class="excel-btn" ref="excelBtnRef">
      <button
        class="btn-excel"
        title="ì—‘ì…€ë‹¤ìš´ë¡œë“œ"
        @click="toggleExcelDropdown"
      >
        ë‚´ë ¤ë°›ê¸°
        <span class="dropdown-arrow" :class="{ active: isExcelDropdownOpen }"
          >â–¼</span
        >
      </button>

      <!-- ğŸ”¥ ë“œë¡­ë‹¤ìš´ ë©”ë‰´ -->
      <div
        class="excel-dropdown"
        :class="{ show: isExcelDropdownOpen }"
        v-show="isExcelDropdownOpen"
      >
        <button
          class="dropdown-item"
          @click="onExcelDownload('all')"
          title="ì „ì²´ ë°ì´í„°ë¥¼ ì—‘ì…€ë¡œ ë‹¤ìš´ë¡œë“œ"
        >
          <!-- <span class="dropdown-icon">ğŸ“Š</span> -->
          ì „ì²´ ê±´
        </button>
        <button
          class="dropdown-item"
          @click="onExcelDownload('filtered')"
          title="í˜„ì¬ ì¡°íšŒëœ ë°ì´í„°ë§Œ ì—‘ì…€ë¡œ ë‹¤ìš´ë¡œë“œ"
        >
          <!-- <span class="dropdown-icon">ğŸ“‹</span> -->
          ì¡°íšŒ ê±´
        </button>
      </div>
    </div>

    <!-- ë§ì¶¤ í•„í„° ì„¤ì • -->
    <AppWindow
      :view="filterWindowView"
      :moveState="true"
      @close="onCloseFilterWindow"
      width="1050px"
      height="auto"
    >
      <FilterSetWindow
        :columnFcDefs="colData"
        :filterGridDefs="paramGridDefs"
        @close="onCloseFilterWindow"
        @filter-set-window-confirm="onFilterConfirm"
      />
    </AppWindow>
  </div>
</template>

<script setup>
  import {
    ref,
    onMounted,
    defineProps,
    watch,
    onActivated,
    onUnmounted,
  } from 'vue';
  import {
    saveIncludeJobTerm,
    saveIncludeJobWord,
    saveIncludeJobDomain,
    saveIncludeJobTermActualizing,
    saveIncludeJobWordActualizing,
    saveIncludeJobDomainActualizing,
  } from '@/utils/cookies';
  import { useActualizingStore } from '@/stores/actualizing';
  import { useDictionaryMngStore } from '@/stores/dictionaryMng';
  import { useDictionarySearchStore } from '@/stores/dictionarySearch';

  import AppWindow from '@/components/ui/AppWindow.vue';
  import FilterSetWindow from '@/components/popWindow/filterSet/FilterSetWindow.vue';
  import ToggleBtn from '@/components/common/ToggleBtn.vue';
  import { storeToRefs } from 'pinia';
  const colData = ref([]);
  const paramGridDefs = ref({});

  const props = defineProps({
    modelValue: {
      type: String,
      default: '',
    },
    resultCount: {
      type: Object,
      default: () => {},
    },
    columnFcDefs: Array, // TopCompì—ì„œ ì „ë‹¬ëœ columnStateë¥¼ ë°›ê¸° ìœ„í•œ prop
    gridDefs: {
      type: Object,
      default: () => {},
    },
    dictionaryGridType: {
      type: String,
      default: '',
    },
    gridName: {
      type: String,
      default: '',
    },
  });

  const searchText = ref('');

  const emit = defineEmits([
    'enter',
    'save',
    'setup',
    'remove',
    'search-type',
    'open-filter-window',
    'filter-window-closed',
    'open-chatbot-window',
    'excel-download',
  ]);

  watch(
    () => props.modelValue,
    (newValue) => {
      searchText.value = newValue;
    }
  );

  // ğŸ”¥ ì—‘ì…€ ë“œë¡­ë‹¤ìš´ ìƒíƒœ ê´€ë¦¬
  const isExcelDropdownOpen = ref(false);
  const excelBtnRef = ref(null);

  // ğŸ”¥ ì—‘ì…€ ë“œë¡­ë‹¤ìš´ í† ê¸€
  const toggleExcelDropdown = () => {
    isExcelDropdownOpen.value = !isExcelDropdownOpen.value;
  };

  // ğŸ”¥ ì—‘ì…€ ë‹¤ìš´ë¡œë“œ ì‹¤í–‰
  const onExcelDownload = (type) => {
    console.log(`ì—‘ì…€ ë‹¤ìš´ë¡œë“œ íƒ€ì…: ${type}`);

    // ë“œë¡­ë‹¤ìš´ ë‹«ê¸°
    isExcelDropdownOpen.value = false;

    // ë¶€ëª¨ ì»´í¬ë„ŒíŠ¸ë¡œ ì´ë²¤íŠ¸ ì „ë‹¬
    if (type === 'all') {
      emit('excel-download', 'all');
    } else if (type === 'filtered') {
      emit('excel-download', 'filtered');
    }
  };

  // ğŸ”¥ ì™¸ë¶€ í´ë¦­ ì‹œ ë“œë¡­ë‹¤ìš´ ë‹«ê¸°
  const handleClickOutside = (event) => {
    if (excelBtnRef.value && !excelBtnRef.value.contains(event.target)) {
      isExcelDropdownOpen.value = false;
    }
  };

  // ğŸ”¥ ESC í‚¤ë¡œ ë“œë¡­ë‹¤ìš´ ë‹«ê¸°
  const handleKeyDown = (event) => {
    if (event.key === 'Escape') {
      isExcelDropdownOpen.value = false;
    }
  };

  // ì‚¬ì „ì¡°íšŒ ì‚¬ì „í‘œì‹œ ë²”ìœ„ ìƒíƒœ
  const {
    termDictionarySearchCode,
    wordDictionarySearchCode,
    domainDictionarySearchCode,
  } = storeToRefs(useDictionarySearchStore());
  // ì‚¬ì „ì¡°íšŒ ì‚¬ì „í‘œì‹œ ë²”ìœ„ ì„¤ì •
  const {
    setTermDictionarySearchCode,
    setWordDictionarySearchCode,
    setDomainDictionarySearchCode,
  } = useDictionarySearchStore();

  // ì‘ì—…í•­ëª© í‘œì‹œ ì—¬ë¶€ ìƒíƒœ
  const { isTermJobVisible, isWordJobVisible, isDomainJobVisible } =
    storeToRefs(useDictionaryMngStore());

  // ì‘ì—…í•­ëª© í‘œì‹œì—¬ë¶€ ì„¤ì •
  const { setIsTermJobVisible, setIsWordJobVisible, setIsDomainJobVisible } =
    useDictionaryMngStore();

  // í‘œì¤€í™” ì‘ì—…í•­ëª© í‘œì‹œ ì—¬ë¶€ ìƒíƒœ
  const {
    isActualizingTermJobVisible,
    isActualizingWordJobVisible,
    isActualizingDomainJobVisible,
  } = storeToRefs(useActualizingStore());

  // í‘œì¤€í™” ì‘ì—…í•­ëª© í‘œì‹œì—¬ë¶€ ì„¤ì •
  const {
    setIsActualizingTermJobVisible,
    setIsActualizingWordJobVisible,
    setIsActualizingDomainJobVisible,
  } = useActualizingStore();

  // ì‘ì—…ìš©ì–´ í‘œì‹œ ì—¬ë¶€ ì„ íƒ
  const selectTermJobVisible = ref(
    isTermJobVisible.value ? 'visible' : 'noneVisible'
  );
  // ì‘ì—…ë‹¨ì–´ í‘œì‹œ ì—¬ë¶€ ì„ íƒ
  const selectWordJobVisible = ref(
    isWordJobVisible.value ? 'visible' : 'noneVisible'
  );
  // ì‘ì—…ë„ë©”ì¸ í‘œì‹œ ì—¬ë¶€ ì„ íƒ
  const selectDomainJobVisible = ref(
    isDomainJobVisible.value ? 'visible' : 'nonVisible'
  );

  const selectActualizingTermJobVisible = ref(
    isActualizingTermJobVisible.value ? 'visible' : 'noneVisible'
  );
  const selectActualizingWordJobVisible = ref(
    isActualizingWordJobVisible.value ? 'visible' : 'noneVisible'
  );
  const selectActualizingDomainJobVisible = ref(
    isActualizingDomainJobVisible.value ? 'visible' : 'nonVisible'
  );

  // ì‚¬ì „ì¡°íšŒ ì‚¬ì „í‘œì‹œ ë²”ìœ„ ê°ì§€ ë° ì„¤ì •
  const selectTermDictionarySearchCode = ref(termDictionarySearchCode.value);
  const selectWordDictionarySearchCode = ref(wordDictionarySearchCode.value);
  const selectDomainDictionarySearchCode = ref(
    domainDictionarySearchCode.value
  );

  watch(selectTermDictionarySearchCode, (newValue) => {
    console.log('selectTermDictionarySearchCode : ', newValue);
    setTermDictionarySearchCode(newValue);
  });

  watch(selectWordDictionarySearchCode, (newValue) => {
    console.log('selectWordDictionarySearchCode : ', newValue);
    setWordDictionarySearchCode(newValue);
  });

  watch(selectDomainDictionarySearchCode, (newValue) => {
    console.log('selectDomainDictionarySearchCode : ', newValue);
    setDomainDictionarySearchCode(newValue);
  });

  // ì‘ì—…ìš©ì–´ í‘œì‹œì—¬ë¶€ ê°ì§€ ë° ì„¤ì •
  watch(selectTermJobVisible, (newValue) => {
    const isTermJobVisible = newValue === 'visible' ? true : false;
    console.log('isTermJobVisible : ', isTermJobVisible);
    setIsTermJobVisible(isTermJobVisible);
    saveIncludeJobTerm(isTermJobVisible);
  });

  // ì‘ì—…ë‹¨ì–´ í‘œì‹œì—¬ë¶€ ê°ì§€ ë° ì„¤ì •
  watch(selectWordJobVisible, (newValue) => {
    const isWordJobVisible = newValue === 'visible' ? true : false;
    console.log('isWordJobVisible : ', isWordJobVisible);
    setIsWordJobVisible(isWordJobVisible);
    saveIncludeJobWord(isWordJobVisible);
  });

  // ì‘ì—…ë„ë©”ì¸ í‘œì‹œì—¬ë¶€ ê°ì§€ ë° ì„¤ì •
  watch(selectDomainJobVisible, (newValue) => {
    const isDomainJobVisible = newValue === 'visible' ? true : false;
    console.log('isDomainJobVisible : ', isDomainJobVisible);
    setIsDomainJobVisible(isDomainJobVisible);
    saveIncludeJobDomain(isDomainJobVisible);
  });

  // í‘œì¤€í™” ì‘ì—…ìš©ì–´ í‘œì‹œì—¬ë¶€ ê°ì§€ ë° ì„¤ì •
  watch(selectActualizingTermJobVisible, (newValue) => {
    const isTermJobVisibleActualizing = newValue === 'visible' ? true : false;
    setIsActualizingTermJobVisible(isTermJobVisibleActualizing);
    saveIncludeJobTermActualizing(isTermJobVisibleActualizing);
  });

  // í‘œì¤€í™” ì‘ì—…ë‹¨ì–´ í‘œì‹œì—¬ë¶€ ê°ì§€ ë° ì„¤ì •
  watch(selectActualizingWordJobVisible, (newValue) => {
    const isWordJobVisibleActualizing = newValue === 'visible' ? true : false;

    setIsActualizingWordJobVisible(isWordJobVisibleActualizing);
    saveIncludeJobWordActualizing(isWordJobVisibleActualizing);
  });

  // í‘œì¤€í™” ì‘ì—…ë„ë©”ì¸ í‘œì‹œì—¬ë¶€ ê°ì§€ ë° ì„¤ì •
  watch(selectActualizingDomainJobVisible, (newValue) => {
    const isDomainJobVisibleActualizing = newValue === 'visible' ? true : false;

    setIsActualizingDomainJobVisible(isDomainJobVisibleActualizing);
    saveIncludeJobDomainActualizing(isDomainJobVisibleActualizing);
  });

  const isJobGrid = ref(props.isJobGrid);

  const searchType = ref('query');

  const onChangeSearchType = () => {
    searchType.value = searchType.value === 'query' ? 'natural-query' : 'query';

    emit('search-type', searchType.value);
  };

  const inputType = ref(true);
  const changeType = () => {
    inputType.value = !inputType.value;
  };

  const onEnter = () => {
    emit('enter', searchText.value);
  };
  const onSave = () => {
    emit('save');
  };
  const onRemove = () => {
    emit('remove');
  };

  const filterWindowView = ref(false);

  const onOpenFilterWindow = () => {
    console.log('props.gridDefs : ', props.gridDefs);
    paramGridDefs.value = props.gridDefs;
    colData.value = props.columnFcDefs;
    console.log('paramGridDefs1: ', paramGridDefs);
    console.log('colData: ', colData);
    filterWindowView.value = true;
  };

  const onCloseFilterWindow = () => {
    filterWindowView.value = false;
    emit('filter-window-closed');
  };
  const onFilterConfirm = (filterSet) => {
    filterWindowView.value = false;
    emit('filter-window-closed', filterSet);
  };

  const onOpenChatBot = () => {
    console.log('onOpenChatBot');
    emit('open-chatbot-window');
  };

  onActivated(() => {
    console.log('onActivated');
    emit('search-type', searchType.value);
  });
  onMounted(() => {
    console.log('onMounted');
    emit('search-type', searchType.value);

    // ğŸ”¥ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
    document.addEventListener('click', handleClickOutside);
    document.addEventListener('keydown', handleKeyDown);
  });

  // ğŸ”¥ ì»´í¬ë„ŒíŠ¸ ì–¸ë§ˆìš´íŠ¸ ì‹œ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì œê±°
  onUnmounted(() => {
    document.removeEventListener('click', handleClickOutside);
    document.removeEventListener('keydown', handleKeyDown);
  });
</script>

<style lang="scss" scoped>
  .divider-vertical {
    width: 2px;
    height: 24px;
    background-color: #bebebe;
    margin: 3px 14px 0px 10px;
  }

  .job-visible-div {
    display: flex;
    align-items: center;
  }
  .job-visible-select {
    width: 100px;
    margin-left: 5px;
  }

  /* ğŸ”¥ ì—‘ì…€ ë‹¤ìš´ë¡œë“œ ë“œë¡­ë‹¤ìš´ ìŠ¤íƒ€ì¼ */
  .excel-btn {
    position: relative;
    display: inline-block;
  }

  .btn-excel {
    display: flex;
    align-items: center;
    gap: 5px;
    padding: 5px 12px;
    background: #379583;
    color: white;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    font-size: 14px;
    font-weight: 500;
    transition: all 0.3s ease;

    &:hover {
      background: #2c7a6b;
      transform: translateY(-1px);
      box-shadow: 0 2px 8px rgba(55, 149, 131, 0.3);
    }

    &:active {
      transform: translateY(0);
    }
  }

  .dropdown-arrow {
    font-size: 10px;
    transition: transform 0.3s ease;

    &.active {
      transform: rotate(180deg);
    }
  }

  .excel-dropdown {
    position: absolute;
    top: 100%;
    left: 0;
    right: 0;
    background: white;
    border: 1px solid #ddd;
    border-radius: 4px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    z-index: 1000;
    opacity: 0;
    transform: translateY(-10px);
    transition: all 0.3s ease;
    overflow: hidden;

    &.show {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .dropdown-item {
    width: 100%;
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 10px 12px;
    background: white;
    color: #333;
    border: none;
    text-align: left;
    cursor: pointer;
    font-size: 14px;
    transition: background-color 0.2s ease;

    &:hover {
      background: #f8f9fa;
      color: #379583;
    }

    &:not(:last-child) {
      border-bottom: 1px solid #eee;
    }
  }

  .dropdown-icon {
    font-size: 16px;
    width: 20px;
    text-align: center;
  }
</style>
